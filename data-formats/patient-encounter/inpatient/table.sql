create or replace table ip_encounter (
  encounter_id String,
  facility_id String,
  patient_id String,

  -- Patient demographic info
  date_of_birth Nullable(Date32),
  sex LowCardinality(String),
  race1 LowCardinality(Nullable(String)),
  race2 LowCardinality(Nullable(String)),
  race3 LowCardinality(Nullable(String)),
  race4 LowCardinality(Nullable(String)),
  race5 LowCardinality(Nullable(String)),
  ethnicity LowCardinality(Nullable(String)),
  preferred_language LowCardinality(String),
  preferred_language_write_in Nullable(String),
  patient_city Nullable(String),
  patient_country Nullable(String),
  patient_county Nullable(String),
  patient_homeless Nullable(String),
  patient_state Nullable(String),
  patient_street Nullable(String),
  patient_zip Nullable(String),
  dnr LowCardinality(String),

  -- Encounter info
  type_of_care LowCardinality(String),
  point_of_origin LowCardinality(String),
  route_of_admission LowCardinality(String),
  type_of_admission LowCardinality(String),
  admission_date Date,
  discharge_date Date,
  disposition LowCardinality(String),
  principal_diagnosis Nullable(String),
  principal_diagnosis_poa Nullable(String),
  other_diagnosis1 Nullable(String),
  other_diagnosis2 Nullable(String),
  other_diagnosis3 Nullable(String),
  other_diagnosis4 Nullable(String),
  other_diagnosis5 Nullable(String),
  other_diagnosis6 Nullable(String),
  other_diagnosis7 Nullable(String),
  other_diagnosis8 Nullable(String),
  other_diagnosis9 Nullable(String),
  other_diagnosis10 Nullable(String),
  other_diagnosis11 Nullable(String),
  other_diagnosis12 Nullable(String),
  other_diagnosis13 Nullable(String),
  other_diagnosis14 Nullable(String),
  other_diagnosis15 Nullable(String),
  other_diagnosis16 Nullable(String),
  other_diagnosis17 Nullable(String),
  other_diagnosis18 Nullable(String),
  other_diagnosis19 Nullable(String),
  other_diagnosis20 Nullable(String),
  other_diagnosis21 Nullable(String),
  other_diagnosis22 Nullable(String),
  other_diagnosis23 Nullable(String),
  other_diagnosis24 Nullable(String),
  other_diagnosis_poa1 Nullable(String),
  other_diagnosis_poa2 Nullable(String),
  other_diagnosis_poa3 Nullable(String),
  other_diagnosis_poa4 Nullable(String),
  other_diagnosis_poa5 Nullable(String),
  other_diagnosis_poa6 Nullable(String),
  other_diagnosis_poa7 Nullable(String),
  other_diagnosis_poa8 Nullable(String),
  other_diagnosis_poa9 Nullable(String),
  other_diagnosis_poa10 Nullable(String),
  other_diagnosis_poa11 Nullable(String),
  other_diagnosis_poa12 Nullable(String),
  other_diagnosis_poa13 Nullable(String),
  other_diagnosis_poa14 Nullable(String),
  other_diagnosis_poa15 Nullable(String),
  other_diagnosis_poa16 Nullable(String),
  other_diagnosis_poa17 Nullable(String),
  other_diagnosis_poa18 Nullable(String),
  other_diagnosis_poa19 Nullable(String),
  other_diagnosis_poa20 Nullable(String),
  other_diagnosis_poa21 Nullable(String),
  other_diagnosis_poa22 Nullable(String),
  other_diagnosis_poa23 Nullable(String),
  other_diagnosis_poa24 Nullable(String),
  principal_procedure Nullable(String),
  principal_procedure_date Nullable(Date),
  other_procedure1 Nullable(String),
  other_procedure2 Nullable(String),
  other_procedure3 Nullable(String),
  other_procedure4 Nullable(String),
  other_procedure5 Nullable(String),
  other_procedure6 Nullable(String),
  other_procedure7 Nullable(String),
  other_procedure8 Nullable(String),
  other_procedure9 Nullable(String),
  other_procedure10 Nullable(String),
  other_procedure11 Nullable(String),
  other_procedure12 Nullable(String),
  other_procedure13 Nullable(String),
  other_procedure14 Nullable(String),
  other_procedure15 Nullable(String),
  other_procedure16 Nullable(String),
  other_procedure17 Nullable(String),
  other_procedure18 Nullable(String),
  other_procedure19 Nullable(String),
  other_procedure20 Nullable(String),
  other_procedure21 Nullable(String),
  other_procedure22 Nullable(String),
  other_procedure23 Nullable(String),
  other_procedure24 Nullable(String),
  other_procedure_date1 Nullable(Date),
  other_procedure_date2 Nullable(Date),
  other_procedure_date3 Nullable(Date),
  other_procedure_date4 Nullable(Date),
  other_procedure_date5 Nullable(Date),
  other_procedure_date6 Nullable(Date),
  other_procedure_date7 Nullable(Date),
  other_procedure_date8 Nullable(Date),
  other_procedure_date9 Nullable(Date),
  other_procedure_date10 Nullable(Date),
  other_procedure_date11 Nullable(Date),
  other_procedure_date12 Nullable(Date),
  other_procedure_date13 Nullable(Date),
  other_procedure_date14 Nullable(Date),
  other_procedure_date15 Nullable(Date),
  other_procedure_date16 Nullable(Date),
  other_procedure_date17 Nullable(Date),
  other_procedure_date18 Nullable(Date),
  other_procedure_date19 Nullable(Date),
  other_procedure_date20 Nullable(Date),
  other_procedure_date21 Nullable(Date),
  other_procedure_date22 Nullable(Date),
  other_procedure_date23 Nullable(Date),
  other_procedure_date24 Nullable(Date),
  external_cause_of_morbidity1 Nullable(String),
  external_cause_of_morbidity2 Nullable(String),
  external_cause_of_morbidity3 Nullable(String),
  external_cause_of_morbidity4 Nullable(String),
  external_cause_of_morbidity5 Nullable(String),
  external_cause_of_morbidity6 Nullable(String),
  external_cause_of_morbidity7 Nullable(String),
  external_cause_of_morbidity8 Nullable(String),
  external_cause_of_morbidity9 Nullable(String),
  external_cause_of_morbidity10 Nullable(String),
  external_cause_of_morbidity11 Nullable(String),
  external_cause_of_morbidity12 Nullable(String),
  external_cause_of_morbidity_poa1 Nullable(String),
  external_cause_of_morbidity_poa2 Nullable(String),
  external_cause_of_morbidity_poa3 Nullable(String),
  external_cause_of_morbidity_poa4 Nullable(String),
  external_cause_of_morbidity_poa5 Nullable(String),
  external_cause_of_morbidity_poa6 Nullable(String),
  external_cause_of_morbidity_poa7 Nullable(String),
  external_cause_of_morbidity_poa8 Nullable(String),
  external_cause_of_morbidity_poa9 Nullable(String),
  external_cause_of_morbidity_poa10 Nullable(String),
  external_cause_of_morbidity_poa11 Nullable(String),
  external_cause_of_morbidity_poa12 Nullable(String),

  -- Payer info
  payer_category LowCardinality(String),
  payer_plan LowCardinality(Nullable(String)),
  payer_type LowCardinality(String),
  total_charges Nullable(UInt32),

  -- Metadata
  created_at DateTime64(6)
)
engine = ReplacingMergeTree(created_at)
order by (encounter_id);
